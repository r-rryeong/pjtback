# Final_PJT (22.05.20 - 22.05.27)

## 🏆프로젝트 목표

+ 영화 데이터 기반 추천 서비스 구성
+ 영화 추천 알고리즘 구성
+ 커뮤니티 서비스 구성
+ HTML, CSS, JavaScript, Vue.js, Django, REST API, Database 등을 활용한 실제 서비스 설계
+ 서비스 관리 및 유지보수



## 📃프로젝트 소개

### 영화 추천 웹 서비스

**1. 영화 조회 서비스**

- 인기순, 상영순, 평점순 영화 조회(TMDB 기반)
- 개봉예정 영화 조회(해당 영화를 선택 시, CGV 내 예매 페이지로 이동)
- 역대 영화 순위 조회
- 연도별(2012년~2022년) 영화 순위 조회
- 영화 상세 페이지에서 영화 정보와 예고편, 해당 영화에 작성된 리뷰 게시글 조회 기능

**2. 영화 추천 서비스**

- 사용자의 '좋아요' 데이터를 기반으로 맞춤 영화 추천 서비스('좋아요'를 누른 영화가 없다면 랜덤으로 추천)
- 랜덤 영화 추천 서비스

**3. Community 기능**

- 영화 리뷰 작성 및 평점 기능 제공
- 리뷰 게시글에 댓글 작성 기능 제공



## ⚒️배포 서버 URL & 개발 환경

### URL

https://namanemovie.netlify.app/




### 개발환경
- python

  python 3.9.9
  
  Django 3.2
  
- Javascript
  
  Vue.js
  
- Database
  
  sqlite3
  
- 도구
  
  Visual Studio Code
  
  Chrome Browser
  
- 아키텍처
  
  Django REST API 서버 & Vue.js



## 🤝팀원 정보 및 업무 분담 내역
### Together
```
- 기획
- 화면 구상
- 모델링
- PPT, 영상 기획
```


### Front-End

👨‍💻**박찬석**
```
- Vue client 구현
- 화면 디자인
- 영상 제작
```


### Back-End

👩‍💻**김성령**
```
- DRS server 구현
- DB 생성
- PPT 제작
```



**notion을 활용한 일정관리 및 회의로그 작성**

![image-20220526212017938](README.assets/image-20220526212017938.png)



## 📢 프로젝트 주요 기능 및 실제 구현 정도

### 데이터 모델링(ERD)

![image-20220524093152722](README.assets/image-20220524093152722.png)

### 주요 기능



#### 회원가입&로그인

<img src="README.assets/image-20220526212738365.png" alt="image-20220526212738365" style="zoom: 50%;" />

<img src="README.assets/image-20220526212844711.png" alt="image-20220526212844711" style="zoom:50%;" />



#### HOME(메인 페이지)

<img src="README.assets/image-20220526213542714.png" alt="image-20220526213542714" style="zoom: 67%;" />

![image-20220526213802077](README.assets/image-20220526213802077.png)

![image-20220526213900605](README.assets/image-20220526213900605.png)

![image-20220526213941690](README.assets/image-20220526213941690.png)

![image-20220526214017766](README.assets/image-20220526214017766.png)

**주요 기능**

상단의 Carousel에 간략한 웹 소개와 인기영화 이미지 출력

현재 인기 영화, 평점 높은 영화, 최신 개봉 영화 조회(포스터나 제목을 클릭 시, 상세페이지로 이동)

개봉 예정 영화 조회(포스터나 제목을 클릭 시, CGV의 예매 페이지로 이동)



#### 영화 상세 페이지

<img src="README.assets/image-20220526214131303.png" alt="image-20220526214131303" style="zoom:67%;" />

![image-20220526215055944](README.assets/image-20220526215055944.png)

![image-20220526215140670](README.assets/image-20220526215140670.png)

**주요 기능**

영화 상세정보 조회(장르, 개봉일, 평점, 줄거리, 예고편)

영화 '찜하기' 와 관람평 작성

영화에 작성된 다른 관람평 조회



#### 관람평&댓글 작성

<img src="README.assets/image-20220526214442569.png" alt="image-20220526214442569" style="zoom:67%;" />

![image-20220526214811690](README.assets/image-20220526214811690.png)

**주요 기능**

관람평 제목과 내용 작성

평점 남기기

수정, 삭제 가능

'돌아가기'버튼으로 영화 상세 페이지로 돌아가기

관람평에 댓글 남기기



#### MOVIE 페이지

![image-20220526215340837](README.assets/image-20220526215340837.png)

<img src="README.assets/image-20220526215520046.png" alt="image-20220526215520046" style="zoom:67%;" />

**주요 기능**

사용자가 '찜하기'를 한 영화들의 장르를 기반으로 영화 추천

랜덤으로 영화 추천

장르별 인기영화 조회



#### BOXOFFICE 페이지

![image-20220526215632205](README.assets/image-20220526215632205.png)

**주요 기능**

역대 박스오피스 조회

연도별 박스오피스 조회(2012년~2022년)



#### MYPICK 페이지

![image-20220526215845509](README.assets/image-20220526215845509.png)

![image-20220526215929683](README.assets/image-20220526215929683.png)

**주요 기능**

사용자 개인 페이지로, 사용자가 '찜하기'한 영화를 조회

감상전, 감상 완료 영화 분류

'안볼래요'를 클릭 시, '찜하기' 취소

사용자가 작성한 관람평 조회



### 초기 목표 서비스 및 실제 구현 정도

**목표 서비스**

```
1. 조회 서비스
- 인기순, 평점순, 개봉순 영화 조회(TMDB 기반)
- 개봉예정 영화 조회
- 영화 상세 페이지 조회(영화 상세 정보, 예고편)
- 역대 박스오피스와 연도별(2012년~2022년) 박스오피스 조회
- 영화 검색 기능

2. 'MYPICK' 서비스
- 사용자의 개인 페이지인 'MYPICK'페이지 구현
- 영화 '좋아요' 기능
- '좋아요'를 기반으로 한 사용자맞춤 영화 추천
- 내가 작성한 관람평 리스트 조회
- 감상전/감상완료 기능

3. Community 서비스
- 관람평 남기기(제목, 내용, 평점)
- 관람평에 댓글 남기기
- 관람평과 댓글 모두 수정 가능
```

**실제 구현 정도**

```
1. 조회 서비스
- 개봉예정 영화 클릭 시 CGV 예매하기 페이지로 이동, 그러나 크롤링한 data이기 때문에 매일 data를 update해줘야함
- 기획을 할 때는 영화 상세 페이지에서 예고편을 폼에 띄울려고 했으나 구현 X
- 박스오피스 navbar의 년도를 역대부터 2022년,···, 2012년 순으로 보여주려고 했으나 구현 X
- 영화 검색 기능 구현 X

2. 'MYPICK' 서비스
- 'MYPICK'페이지 구현 O
+ 감상전/감상완료 목록에서 삭제 기능

3. Community 서비스
- Community 기능 구현 O
```



## 💡배운점

### 박찬석

**1. 디자인 구상**

- 프로젝트 기획단계에서 진행 한 작업 입니다. 개발 단계 전에 구현할 기능을 토의하고 요구사항에 맞게 사전에 목업 페이지를 제작하였습니다. 사용 툴은 카카오 오븐 입니다. 

**2. 비동기 통신**

- 장고 서버의 데이터베이스에 접근 하기 위해서 Axios의 비동기 통신을 이용하였는데, 이번 프로젝트를 진행하면서 오류 발생 원인의 높은 지분을 가지고 있다. 우선 에러가 발생한 원인은 비동기 통신을 요청 후 응답을 받기 전에 동기적인 작업이 먼저 실행되어 값이 빈 상태로 실행되어 오류가 발생하였는데 이를 해결하기 위해 .then과 .catch를 이용하는 Promise와 Vue 인스턴스에서는 v-if문과 삼항 연산자를 이용하여 값이 있을 경우에만 함수가 실행될 수 있게 수정하여 오류를 해결하였습니다.
- 새로고침시 데이터가 날라가는 문제를 해결하기 위해 중요한 정보는 로컬스토리지를 이용하여 저장하는 방법을 이용하였습니다.

**3. 라우터**

- 이번 프로젝트에서 Vuex를 이용하면서 하나의 페이지에서 작동하는 SPA와 SFC를 적용하였는데, SPA를 이용하기 위해 Vue 라우터를 적용하게 되었습니다. URL의 주소는 변경되지만 실제로는 페이지 이동없이 작업을 처리하기 때문에 장고 DRF서버에 접근 하기 위해 drf.js 파일을 만들어 Vue 주소와 장고 서버 주소를 동기화 시켜주었습니다.

**4. Vuex**

- Vue를 이용하여 다른 컴포넌트에게 데이터를 전달할 때 pros와 emit을 이용하지 않고 Vuex를 적용하여 전역에서 state를 이용하여 데이터를 주고 받을 수 있도록 구현하였습니다. Vuex의 상태관리 패턴을 이해하기 위해 Store의 핵심 구조와 호출 방법을 알게 되었고 컴포넌트에서 데이터를 접근할 때는 Getters를 이용하여 state를 간접 참고하고 Mutations에 데이터를 저장할 때는 Actions 함수를 이용하여 진행하였습니다.

**5. 인증과 배포**

- 회원가입이나 로그인, 장고에 DB를 요청할 때 인증된 사용자만 접근이 가능한 경우에 DRF 권한이 필요했습니다. 이를 해결하기 위해 서버에 요청을 보낼 때 로그인 된 사용자의 Token 값을 Header에 넣어 같이 요청을 했습니다. 
- netlify를 이용하여 Front 배포를 완료하고 장고 서버와 연동을 하였는데 페이지 이동시 404에러가 계속 발생하였습니다. 원인을 찾아보니 이번 프로젝트에서 SPA를 이용하기 위해 구현된 Vue라우터 기능때문에 발생하는 오류였습니다. 서버에서는 계속 새로운 주소를 요청하는데 Vue에서는 페이지 이동이 실제로 일어나지 않아서 발생하는 문제였습니다. 이를 해결하기 위해 서버에서 요청이 오면 항상 index로 redirect하는 코드가 담겨있는 _redirects 파일을 public 폴더에 저장하여 해결할 수 있었습니다.

### 김성령

**1. DB**

- 필요한 data를 DB에 저장해야한다. TMDB API key를 이용해 요청을 보내고 응답을 받아와서 json파일로 저장하고 json 파일을 loaddata해서 DB에 저장한다. 구조를 잘 이해하지 못해서 처음에 많이 헤맸다. app 내에 .py 에서 실행하면 해당 app 내에 json파일이 생기고 app 내에 fixtures 파일 내로 옮겨서 loaddata를 실행하면 DB에 저장된다. model에 맞게 data를 받아와야해서 오류도 많이 만났다.

  ```
  'integrityerror: foreign key constraint failed'
  ⇒ FK에 값이 없다. 이 경우 다른 json파일을 먼저 DB에 저장하고 다시 시도해보자
  ```

**2. 모델링**

- 필요한 data를 client와 논의하고 그에 맞게 ERD를 구상하고 시작하는 것이 중요하다. 모델링을 먼저 하고 진행하는 것이 효율적이다.
- client와 server 연동이 익숙하지 않아서 model과 serializer를 수정하면서 진행했다. 초기에 모델링을 해놓고 시작하지 않았으면 더 많은 수정이 필요했을 것 같다.

**3. 크롤링**

- 메인 화면의 영화 조회 기능들은 TMDB data를 활용해서 구현할 수 있었지만 개봉 예정 영화나 박스오피스 data는 찾을 수가 없어서 크롤링이 필요했다.
- 필요한 요소를 선택할 때 페이지 구조가 복잡한 경우 시간이 오래 걸렸다. 필요한 요소를 선택하기 위해 BeautifulSoup 사용법을 많이 찾아봤다.
- 알고리즘을 이용해서 크롤링한 data를 약간 수정할 수도 있었다.(포스터 url)

**4. ORM**

- 영화 추천 알고리즘을 짤 때 ORM을 사용해야해서 많이 헤맸다. 역참조와 ORM에 익숙하지 않아서 model관계와 공식문서, ORM cookbook을 많이 찾아보면서 진행했다.
- 디버깅을 위해 shell_plus를 이용했다.

```
TypeErroe: 'manyrelatedmanager' object is not iterable
⇒ manytomany field를 for문 돌릴 경우, field명 뒤에 .all을 붙이자
```

**5. 배포**

- server는 heroku를 이용해서 배포할 수 있었다. 처음 사용해보는거라 시작할 때 이리저리 헤매면서 구글링을 엄청 한 것 같다. 공식문서를 참고하면서 한단계씩 해나가니까 생각만큼 오래 걸리지는 않았다.

- server 배포는 했는데 DB를 받아오지 못해서 헤맸다. django에 DB가 잘 저장돼있고 heroku랑 DB 연결도 됐는데 왜 안될까 하다가 구글링을 통해 heroku에서도 loaddata를 해줘야 한다는 것을 알게 됐다.

- vue와 연동하는데에서 한 번 더 헤맸다. heroku에 같이 push를 해야하는 것인지 vue는 netlify를 사용하면 되는 것인지 이리저리 찾아보다가 vue는 netlify를 사용하고, vue에서 요청을 보낼 때 주소를 server url로 바꿔주니 해결되었다.

  [참고 문서] https://developer.mozilla.org/ko/docs/Learn/Server-side/Django/Deployment





## 🌻기타(느낀점)

### 🌱박찬석

**기획 단계**

  목업 페이지를 제작함으로써 실제 개발단계에서 기본 구조를 잡는데 큰 도움이 되었고 오히려 빠르게 개발을 시작하고 개발 단계에서 디자인을 정할 때 보다 시작은 늦었지만 훨씬 빠르게 프론트 구조를 잡고 스타일링 하는데 도움이 많이 되었습니다.

  이를 통해 느낀점은 프로젝트에서 개발단계가 매우 큰 부분을 차지하지만 이에 못지 않게 기획단계의 중요성을 실감했습니다. 기획을 꼼꼼히 하고 프로젝트를 시작할 수록 큰 문제 없이 프로젝트를 마무리 할 확률이 높다는 것을 깨달았습니다.

**오류**

  이번 프로젝트를 진행하면서 정말 많은 오류가 발생하였는데 기존에는 수업시간에 알려주시거나 교수님이 대부분 해결을 해주셨는데 이번에는 모든 오류를 스스로 해결해야 했습니다. 오류를 해결하기 위해 어떤날은 개발시간 보다 많은 시간을 쏟은 날도 있었는데 그래도 수많은 시행착오를 통해 결국 오류를 모두 해결할 수 있었습니다. 이를 위해 수많은 검색을 통해 오류를 찾아보고 같은 원인을 해결한 자료가 있는지 찾아볼 수 있었는데 높은 확률로 같은 오류를 미리 접하고 해결방법을 알려주는 글들이 많이 있다는 것을 알게 되었습니다. 이렇게 오류를 도움 없이 스스로 해결하다 보니 다음번에는 같은 실수를 반복하지 않고 해당 부분을 더 완벽하게 이해하고 사용할 수 있다는 것을 깨달았습니다. 이를 통해 느낀점은 훌륭한 개발자가 되기 위해 오류가 발생하면 스스로 해결하는 경험은 꼭 필요하다는 것을 느꼈습니다. 

**소감**

  이번 최종 프로젝트를 협으로 함께 진행하면서 느낀점은 개발 능력도  물론 중요하지만 개발 팀원들간의 원활한  소통이 매우 중요하다는 것을 느꼈습니다. 앞으로도 프로젝트를 진행하면서 혼자 진행하는 것보다는 여러개발자들과 같이 진행하는 프로젝트가 대부분일텐데 협업능력의 중요함을 많이 깨달았던 것 같습니다. 서로 역할을 분담을 하고 소통을 하면서 각자 역할에 최선을 다하다보면 플러스 알파의 효과가 발생하는 것을 알게 되었습니다. 그래서 프로젝트를 진행하면서 서로 소통이 잘되고 협업이 성공적으로 진행된다면 팀원들의 개발 능력이 제각각이라도 전혀 문제가 없을 것 같다는 생각을 했습니다. 개발비중이 높은 팀원은 개발에 좀 더 힘을 쏟고 다른 팀원분들은 또 각각 맡아주실 다른 역할들이 너무나도 많기 때문입니다.  이를 통해 훌륭한 개발자로 성장하기 위해 개발능력도 물론 중요하지만 협업능력을 비롯해 기획하고 관리, 꼼꼼한 기록 등 다른 부분도 같이 신경쓰고 능력을 기르도록 노력해야 한다는 것을 깨달았습니다. 한 주간 진행하면서 잠도 줄이고 정말 많은 고생을 했지만 원하는 기능을 구현하고 점차 완성되어가는 결과물을 보면서 정말 보람차고 성장해 가는 것을 느끼는 훌륭한 경험이었습니다.



### 🌱김성령

**디버깅**

back을 진행하면서 가장 크게 막혔던 부분이 DB저장, 크롤링, 영화 추천 알고리즘 작성 부분이였다.

DB저장, 크롤링을 할때는 출력이 되는지 확인하면서 진행하고 추천 알고리즘을 짤 때는 shell_plus와 postman을 통해 어느 부분까지 접근했는지 확인하면서 진행하니까 결과가 눈에 확 보이고 해결하는데 큰 도움이 된것같다.

**공식문서**

이번 프로젝트는 스스로 해결해야해서 처음에 오류를 만났을 때 막막했다. 계속 구글링을하고 공식문서를 많이 참고했다. 하다보니까 구글링을 해서 필요한 부분을 알아내는 것도 실력임을 느꼈고 내가 만난 오류는 이미 누군가는 겪었던 오류임을 알게 됐다. 구글링을 많이 하고 스스로 오류를 해결하는게 실력 향상에 도움이 된다는 것을 알게 됐다.

**커뮤니케이션**

client와 server를 연동해야하는 프로젝트이다보니 back과 front의 커뮤니케이션이 중요했던 것 같다. 비대면이라 소통에 불편함이 있을 수도 있었지만 Discord와 Notion을 적극 활용하여 원만한 소통이 가능했던 것 같다.

계속해서 의논하며  약 550개의 영화 data를 형식에 맞춰 client로 전달했고, 그 과정에서 단순히 data를 넘긴다는 것보다는 back에서 최대한 로직을 작성해서 front로 보내기 위해 노력했다.

